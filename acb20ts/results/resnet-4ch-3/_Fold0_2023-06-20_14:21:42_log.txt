2023-06-20 14:21:44,636 - INFO -main-                main():40 - Set logger output path: acb20ts/results/resnet-4ch-3/_Fold0_2023-06-20_14:21:42_log.txt 
2023-06-20 14:21:44,636 - INFO -main-                main():41 - Config 
 DATASET:
  DATASET_CLASS: generic
  IMAGE_MODALITY: CMRI
  LANDMARKS: [3]
  NAME: APSIRE_MEDIUM_4CH
  ROOT: /shared/ai4h/Shared/Data/medical/CMRI/PAH-Baseline/Proc/4ch
  SRC_TARGETS: /shared/ai4h/Shared/Data/medical/CMRI/PAH-Baseline/Proc/landmark_localisation_annotations/4ch
  TRAINSET_SIZE: -1
INFERENCE:
  DEBUG: True
  ENSEMBLE_CHECKPOINTS: []
  ENSEMBLE_INFERENCE: False
  ENSEMBLE_UNCERTAINTY_KEYS: ['smha', 'emha', 'ecpv']
  EVALUATION_MODE: scale_heatmap_first
  FIT_GAUSS: False
  SPLIT: testing
  UNCERTAINTY_SMHA_MODEL_IDX: 0
INFERRED_ARGS:
  GEN_HM_IN_MAINTHREAD: False
  RESIZE_FIRST: True
  USE_FULL_RES_COORDS: True
MODEL:
  ARCHITECTURE: PHD-Transformer
  CHECKPOINT: None
  GAUSS_SIGMA: 2
  HM_LAMBDA_SCALE: 100.0
  PHDNET:
    BRANCH_SCHEME: multi
    CLAMP_DIST: None
    CLASS_LABEL_SCHEME: gaussian
    LOG_TRANSFORM_DISPLACEMENTS: True
    MAXPOOL_FACTOR: 4
    WEIGHT_DISP_LOSS_BY_HEATMAP: True
  UNET:
    INIT_FEATURES: 32
    MAX_FEATURES: 512
    MIN_FEATURE_RESOLUTION: 4
OUTPUT:
  COMET_API_KEY: 8boE94zBSIbb7iJ0kaf2d0WGl
  COMET_PROJECT_NAME: resnet-phd
  COMET_TAGS: ['default']
  COMET_WORKSPACE: tomsmith01
  LOGGER_OUTPUT: acb20ts/results/resnet-4ch-3/_Fold0_2023-06-20_14:21:42_log.txt
  OUTPUT_DIR: acb20ts/results/resnet-4ch-3
  RESULTS_CSV_APPEND: None
  USE_COMETML_LOGGING: False
  VERBOSE: True
SAMPLER:
  DATA_AUG: AffineComplex
  DATA_AUG_PACKAGE: imgaug
  DEBUG: False
  EVALUATION_SAMPLE_MODE: full
  INPUT_SIZE: [512, 512]
  NUM_WORKERS: 9
  PATCH:
    CENTRED_PATCH_COORDINATE_PATH: None
    CENTRED_PATCH_COORDINATE_PATH_SHEET: None
    CENTRED_PATCH_JITTER: 0.0
    INFERENCE_MODE: fully_convolutional
    RESOLUTION_TO_SAMPLE_FROM: [512, 512]
    SAMPLER_BIAS: 0.66
    SAMPLE_PATCH_SIZE: [128, 128]
  SAMPLE_MODE: full
SOLVER:
  AUTO_MIXED_PRECISION: True
  BASE_LR: 0.001
  DATA_LOADER_BATCH_SIZE_EVAL: 12
  DATA_LOADER_BATCH_SIZE_TRAIN: 12
  DECAY_POLICY: poly
  DEEP_SUPERVISION: False
  EARLY_STOPPING_PATIENCE: 150
  LOSS_FUNCTION: mse
  MAX_EPOCHS: 500
  MINI_BATCH_SIZE: 150
  NUM_RES_SUPERVISIONS: 1
  REGRESS_SIGMA: False
  REGRESS_SIGMA_LOSS_WEIGHT: 0.005
  SEED: None
SSH:
  AUTO_AMEND_PATHS: True
  LOCAL_PATH_TO_SSH_MOUNT: /mnt/bess
  MATCH_SSH_STRING_FOR_AMEND: /shared/tale2/
TRAINER:
  CACHE_DATA: False
  FOLD: 0
  INFERENCE_ONLY: True
  PERFORM_VALIDATION: True
  SAVE_EVERY: 10
  SAVE_LATEST_ONLY: True
  VALIDATE_EVERY: 10 
2023-06-20 14:21:45,641 - INFO -model_trainer_base-     _maybe_init_amp():257 - initialized auto mixed precision.
2023-06-20 14:21:45,641 - INFO -main-                main():104 - TESTING PHASE
2023-06-20 14:21:45,641 - INFO -main-                main():161 - Loading MODELS that match substrings in: ['model_best_valid_loss', 'model_best_valid_coord_error', 'model_latest']
2023-06-20 14:21:45,641 - INFO -main-                main():194 - saving summary of results locally to: acb20ts/results/resnet-4ch-3/summary_results_fold0.xlsx
2023-06-20 14:21:45,651 - INFO -main-                main():207 - saving individual sample results locally to: acb20ts/results/resnet-4ch-3/individual_results_fold0.xlsx
